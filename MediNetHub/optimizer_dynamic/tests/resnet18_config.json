{
    "name": "ResNet18-like",
    "layers": [
        {"id": "input_layer", "type": "input", "params": {}},
        
        {"id": "conv1", "type": "conv2d", "params": {"in_channels": 3, "out_channels": 64, "kernel_size": 7, "stride": 2, "padding": 3, "bias": false}, "inputs": ["input_layer"]},
        {"id": "bn1", "type": "batchnorm2d", "params": {"num_features": 64}, "inputs": ["conv1"]},
        {"id": "relu1", "type": "relu", "params": {"inplace": true}, "inputs": ["bn1"]},
        {"id": "pool1", "type": "maxpool2d", "params": {"kernel_size": 3, "stride": 2, "padding": 1}, "inputs": ["relu1"]},

        {"id": "l1_b1_conv1", "type": "conv2d", "params": {"in_channels": 64, "out_channels": 64, "kernel_size": 3, "stride": 1, "padding": 1, "bias": false}, "inputs": ["pool1"]},
        {"id": "l1_b1_bn1", "type": "batchnorm2d", "params": {"num_features": 64}, "inputs": ["l1_b1_conv1"]},
        {"id": "l1_b1_relu1", "type": "relu", "params": {"inplace": true}, "inputs": ["l1_b1_bn1"]},
        {"id": "l1_b1_conv2", "type": "conv2d", "params": {"in_channels": 64, "out_channels": 64, "kernel_size": 3, "stride": 1, "padding": 1, "bias": false}, "inputs": ["l1_b1_relu1"]},
        {"id": "l1_b1_bn2", "type": "batchnorm2d", "params": {"num_features": 64}, "inputs": ["l1_b1_conv2"]},
        {"id": "l1_b1_add", "type": "Add", "inputs": ["l1_b1_bn2", "pool1"]},
        {"id": "l1_b1_relu2", "type": "relu", "params": {"inplace": true}, "inputs": ["l1_b1_add"]},

        {"id": "l1_b2_conv1", "type": "conv2d", "params": {"in_channels": 64, "out_channels": 64, "kernel_size": 3, "stride": 1, "padding": 1, "bias": false}, "inputs": ["l1_b1_relu2"]},
        {"id": "l1_b2_bn1", "type": "batchnorm2d", "params": {"num_features": 64}, "inputs": ["l1_b2_conv1"]},
        {"id": "l1_b2_relu1", "type": "relu", "params": {"inplace": true}, "inputs": ["l1_b2_bn1"]},
        {"id": "l1_b2_conv2", "type": "conv2d", "params": {"in_channels": 64, "out_channels": 64, "kernel_size": 3, "stride": 1, "padding": 1, "bias": false}, "inputs": ["l1_b2_relu1"]},
        {"id": "l1_b2_bn2", "type": "batchnorm2d", "params": {"num_features": 64}, "inputs": ["l1_b2_conv2"]},
        {"id": "l1_b2_add", "type": "Add", "inputs": ["l1_b2_bn2", "l1_b1_relu2"]},
        {"id": "l1_b2_relu2", "type": "relu", "params": {"inplace": true}, "inputs": ["l1_b2_add"]},

        {"id": "l2_b1_downsample_conv", "type": "conv2d", "params": {"in_channels": 64, "out_channels": 128, "kernel_size": 1, "stride": 2, "bias": false}, "inputs": ["l1_b2_relu2"]},
        {"id": "l2_b1_downsample_bn", "type": "batchnorm2d", "params": {"num_features": 128}, "inputs": ["l2_b1_downsample_conv"]},
        {"id": "l2_b1_conv1", "type": "conv2d", "params": {"in_channels": 64, "out_channels": 128, "kernel_size": 3, "stride": 2, "padding": 1, "bias": false}, "inputs": ["l1_b2_relu2"]},
        {"id": "l2_b1_bn1", "type": "batchnorm2d", "params": {"num_features": 128}, "inputs": ["l2_b1_conv1"]},
        {"id": "l2_b1_relu1", "type": "relu", "params": {"inplace": true}, "inputs": ["l2_b1_bn1"]},
        {"id": "l2_b1_conv2", "type": "conv2d", "params": {"in_channels": 128, "out_channels": 128, "kernel_size": 3, "stride": 1, "padding": 1, "bias": false}, "inputs": ["l2_b1_relu1"]},
        {"id": "l2_b1_bn2", "type": "batchnorm2d", "params": {"num_features": 128}, "inputs": ["l2_b1_conv2"]},
        {"id": "l2_b1_add", "type": "Add", "inputs": ["l2_b1_bn2", "l2_b1_downsample_bn"]},
        {"id": "l2_b1_relu2", "type": "relu", "params": {"inplace": true}, "inputs": ["l2_b1_add"]},

        {"id": "l2_b2_conv1", "type": "conv2d", "params": {"in_channels": 128, "out_channels": 128, "kernel_size": 3, "stride": 1, "padding": 1, "bias": false}, "inputs": ["l2_b1_relu2"]},
        {"id": "l2_b2_bn1", "type": "batchnorm2d", "params": {"num_features": 128}, "inputs": ["l2_b2_conv1"]},
        {"id": "l2_b2_relu1", "type": "relu", "params": {"inplace": true}, "inputs": ["l2_b2_bn1"]},
        {"id": "l2_b2_conv2", "type": "conv2d", "params": {"in_channels": 128, "out_channels": 128, "kernel_size": 3, "stride": 1, "padding": 1, "bias": false}, "inputs": ["l2_b2_relu1"]},
        {"id": "l2_b2_bn2", "type": "batchnorm2d", "params": {"num_features": 128}, "inputs": ["l2_b2_conv2"]},
        {"id": "l2_b2_add", "type": "Add", "inputs": ["l2_b2_bn2", "l2_b1_relu2"]},
        {"id": "l2_b2_relu2", "type": "relu", "params": {"inplace": true}, "inputs": ["l2_b2_add"]},
        
        {"id": "avgpool", "type": "adaptiveavgpool2d", "params": {"output_size": [1, 1]}, "inputs": ["l2_b2_relu2"]},
        {"id": "flatten", "type": "flatten", "params": {}, "inputs": ["avgpool"]},
        {"id": "fc", "type": "linear", "params": {"in_features": 128, "out_features": 1000}, "inputs": ["flatten"]},
        
        {"id": "output_layer", "type": "output", "inputs": ["fc"]}
    ],
    "output_layers": ["output_layer"]
} 